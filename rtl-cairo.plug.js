function u(t){let e=atob(t),n=e.length,o=new Uint8Array(n);for(let r=0;r<n;r++)o[r]=e.charCodeAt(r);return o}function c(t){typeof t=="string"&&(t=new TextEncoder().encode(t));let e="",n=t.byteLength;for(let o=0;o<n;o++)e+=String.fromCharCode(t[o]);return btoa(e)}var A=new Uint8Array(16);var l=class{constructor(e="",n=1e3){this.prefix=e;this.maxCaptureSize=n;this.prefix=e,this.originalConsole={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug.bind(console)},this.patchConsole()}originalConsole;logBuffer=[];patchConsole(){let e=n=>(...o)=>{let r=this.prefix?[this.prefix,...o]:o;this.originalConsole[n](...r),this.captureLog(n,o)};console.log=e("log"),console.info=e("info"),console.warn=e("warn"),console.error=e("error"),console.debug=e("debug")}captureLog(e,n){let o={level:e,timestamp:Date.now(),message:n.map(r=>{if(typeof r=="string")return r;try{return JSON.stringify(r)}catch{return String(r)}}).join(" ")};this.logBuffer.push(o),this.logBuffer.length>this.maxCaptureSize&&this.logBuffer.shift()}async postToServer(e,n){if(this.logBuffer.length>0){let r=[...this.logBuffer];this.logBuffer=[];try{if(!(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.map(s=>({...s,source:n})))})).ok)throw new Error("Failed to post logs to server")}catch(i){console.warn("Could not post logs to server",i.message),this.logBuffer.unshift(...r)}}}},g;function f(t=""){return g=new l(t),g}var a=t=>{throw new Error("Not initialized yet")},d=typeof window>"u"&&typeof globalThis.WebSocketPair>"u";typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var p=new Map,y=0;d&&(globalThis.syscall=async(t,...e)=>await new Promise((n,o)=>{y++,p.set(y,{resolve:n,reject:o}),a({type:"sys",id:y,name:t,args:e})}));function m(t,e,n){d&&(a=n,self.addEventListener("message",o=>{(async()=>{let r=o.data;switch(r.type){case"inv":{let i=t[r.name];if(!i)throw new Error(`Function not loaded: ${r.name}`);try{let s=await Promise.resolve(i(...r.args||[]));a({type:"invr",id:r.id,result:s})}catch(s){console.error("An exception was thrown as a result of invoking function",r.name,"error:",s.message),a({type:"invr",id:r.id,error:s.message})}}break;case"sysr":{let i=r.id,s=p.get(i);if(!s)throw Error("Invalid request id");p.delete(i),r.error?s.reject(new Error(r.error)):s.resolve(r.result)}break}})().catch(console.error)}),a({type:"manifest",manifest:e}),f(`[${e.name} plug]`))}async function x(t,e){if(typeof t!="string"){let n=new Uint8Array(await t.arrayBuffer()),o=n.length>0?c(n):void 0;e={method:t.method,headers:Object.fromEntries(t.headers.entries()),base64Body:o},t=t.url}return syscall("sandboxFetch.fetch",t,e)}globalThis.nativeFetch=globalThis.fetch;function C(){globalThis.fetch=async function(t,e){let n=e&&e.body?c(new Uint8Array(await new Response(e.body).arrayBuffer())):void 0,o=await x(t,e&&{method:e.method,headers:e.headers,base64Body:n});return new Response(o.base64Body?u(o.base64Body):null,{status:o.status,headers:o.headers})}}d&&C();async function h(){let t=`
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap');
    .cm-content, textarea, input, [contenteditable="true"] {
      direction: rtl !important;
      text-align: right !important;
      font-family: 'Cairo', sans-serif !important;
    }
  `,e=document.createElement("style");e.innerHTML=t,document.head.appendChild(e),await editor.flashNotification("\u062A\u0645 \u062A\u0641\u0639\u064A\u0644 \u0627\u0644\u0643\u062A\u0627\u0628\u0629 \u0645\u0646 \u0627\u0644\u064A\u0645\u064A\u0646 \u0625\u0644\u0649 \u0627\u0644\u064A\u0633\u0627\u0631 \u0628\u062E\u0637 Cairo")}var w={enableRTL:h},b={name:"rtl-cairo",functions:{enableRTL:{path:"rtl-cairo.ts:enableRTL",command:{name:"\u0627\u0644\u0643\u062A\u0627\u0628\u0629 RTL \u0628\u062E\u0637 Cairo",description:"\u064A\u064F\u0641\u0639\u0651\u0644 \u0627\u0644\u0643\u062A\u0627\u0628\u0629 \u0645\u0646 \u0627\u0644\u064A\u0645\u064A\u0646 \u0625\u0644\u0649 \u0627\u0644\u064A\u0633\u0627\u0631 \u0628\u062E\u0637 Cairo"}}},assets:{}},L={manifest:b,functionMapping:w};m(w,b,self.postMessage);export{L as plug};
